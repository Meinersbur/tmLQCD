\section{Fermion Field File Formats}

We note at the beginning, that we do not use a different format for
source or sink fermion fields. They are both stored using the same
lime records. The meta-data stored in the same lime-packed file is
supposed to clarify all other things.

Here we mainly concentrate on storing propagators (sink). The file can
contain only sources, or both, source and sink. We (plan to) support
four different formats
\begin{enumerate}
\item (arbitrary number of) sink, no sources
\item (arbitrary number of) source/sink pairs
\item one source, 12 sink
\item one source, 4 sink
\end{enumerate}
This is very similar to the formats in use in parts of the US
community. However, they use XML as a markup language, which we don't
(yet) use.

An open issue is an appropriate checksum. The maybe easiest is to
implement the SCIDAC checksum.

Every source and sink has to be in a seperate lime record. The order
in one file for the four formats mentioned above is supposed to be 
\begin{enumerate}
\item sink, no sources: -
\item source/sink pairs: first source, then sink
\item one source, 12 sink: first source, then 12 sinks
\item one source, 4 sink: first source, then 4 sinks
\end{enumerate}
All fermion field files must have a record indicating the type. The
record itself is of type {\ttfamily etmc-propagator-type} and the
record has a single entry (ascii string) which can contain one of 
\begin{itemize}
\item {\ttfamily DiracFermion\_Sink}
\item {\ttfamily DiracFermion\_Source\_Sink\_Pairs}
\item {\ttfamily DiracFermion\_ScalarSource\_TwelveSink}
\item {\ttfamily DiracFermion\_ScalarSource\_FourSink}
\end{itemize}
Those strings are also used in the input files of the hmc code for the
input parameter {\ttfamily PropagatorType}.
The binary data corresponding to one Dirac fermion field (source or
sink) is then stored with at least two (three) records. The first is
of type \\
{\ttfamily etmc-propagator-format} \\
and should contain the following information:
\begin{verbatim}
<?xml version="1.0" encoding="UTF-8"?>
<etmcFormat>
  <field>diracFermion</field>
  <precision>32</precision>
  <flavours>1</flavours>
  <lx>4</lx>
  <ly>4</ly>
  <lz>4</lz>
  <lt>4</lt>
</etmcFormat>
\end{verbatim}
The {\ttfamily flavours} entry must be set to {\ttfamily 1} for a one
flavour propagator (flavour diagonal operator) and to {\ttfamily 2} for a two
flavour propagator (flavour non-diagonal 2-flavour operator). In the
former case there follows one record of type
{\ttfamily scidac-binary-data}, which is identical to the SCIDAC
format, containing the fermion field. In the latter case there follow
two of such records, the first of which is the upper flavour.
Any number of other records can be added for convenience.

The first two types are by now supported. In the future the other two
might follow.

The indices in the binary data {\ttfamily scidac-binary-data} are in
the following order:
\[
t, z, y, x, s, c
\]
The binary data is stored big endian and either in single or in double
precision, depending on the {\ttfamily precision} parameter in the
{\ttfamily etmc-propagator-format} record.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "main"
%%% End: 
